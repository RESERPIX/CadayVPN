{"ast":null,"code":"import React,{useState}from'react';import{useLocation,useNavigate}from'react-router-dom';import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";const Payment=()=>{const location=useLocation();const{tariffName,tariffPrice}=location.state||{tariffName:'',tariffPrice:0};const[cardNumber,setCardNumber]=useState('');const[expiryDate,setExpiryDate]=useState('');const[cvv,setCvv]=useState('');const[error,setError]=useState('');const[paymentMethod,setPaymentMethod]=useState('creditCard');const navigate=useNavigate();const handlePayment=async()=>{if(!cardNumber||!expiryDate||!cvv){setError('Пожалуйста, заполните все поля.');return;}const isCardValid=validateCard(cardNumber);if(!isCardValid){setError('Некорректный номер карты.');return;}const randomUserId=Math.floor(Math.random()*5)+1;try{const response=await fetch(`http://localhost:5000/purchase-key`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:randomUserId})});const data=await response.json();if(response.ok){navigate('/confirmation',{state:{tariffName,tariffPrice,vpnKey:data.vpnKey}});}else{setError(data.message||'Не удалось получить VPN-ключ.');}}catch(err){console.error('Ошибка при получении ключа:',err);setError('Ошибка сервера. Пожалуйста, попробуйте позже.');}};const validateCard=number=>{return /^\\d{16}$/.test(number);};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center h-screen bg-gray-900 p-4 text-white\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-5xl font-bold mb-4\",children:[\"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0430 \\u0442\\u0430\\u0440\\u0438\\u0444\\u0430: \",tariffName]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl mb-4\",children:[\"\\u0426\\u0435\\u043D\\u0430: \",tariffPrice,\" \\u20BD \\u0432 \\u043C\\u0435\\u0441\\u044F\\u0446\"]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-400 mb-4\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-2\",children:\"\\u0421\\u043F\\u043E\\u0441\\u043E\\u0431\\u044B \\u043E\\u043F\\u043B\\u0430\\u0442\\u044B:\"}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center mb-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:\"creditCard\",checked:paymentMethod==='creditCard',onChange:e=>setPaymentMethod(e.target.value),className:\"mr-2 accent-blue-500\"}),\"\\u041A\\u0440\\u0435\\u0434\\u0438\\u0442\\u043D\\u0430\\u044F \\u043A\\u0430\\u0440\\u0442\\u0430\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center mb-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:\"paypal\",checked:paymentMethod==='paypal',onChange:e=>setPaymentMethod(e.target.value),className:\"mr-2 accent-blue-500\"}),\"PayPal\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center mb-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:\"yandexMoney\",checked:paymentMethod==='yandexMoney',onChange:e=>setPaymentMethod(e.target.value),className:\"mr-2 accent-blue-500\"}),\"\\u042F\\u043D\\u0434\\u0435\\u043A\\u0441.\\u0414\\u0435\\u043D\\u044C\\u0433\\u0438\"]})]}),paymentMethod==='creditCard'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u043A\\u0430\\u0440\\u0442\\u044B\",value:cardNumber,onChange:e=>setCardNumber(e.target.value),className:\"p-3 border border-gray-700 rounded mb-4 w-80 bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0421\\u0440\\u043E\\u043A \\u0434\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F (MM/YY)\",value:expiryDate,onChange:e=>setExpiryDate(e.target.value),className:\"p-3 border border-gray-700 rounded mb-4 w-80 bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"CVV\",value:cvv,onChange:e=>setCvv(e.target.value),className:\"p-3 border border-gray-700 rounded mb-4 w-80 bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePayment,className:\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md\",children:\"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0438\\u0442\\u044C\"})]});};export default Payment;","map":{"version":3,"names":["React","useState","useLocation","useNavigate","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","Payment","location","tariffName","tariffPrice","state","cardNumber","setCardNumber","expiryDate","setExpiryDate","cvv","setCvv","error","setError","paymentMethod","setPaymentMethod","navigate","handlePayment","isCardValid","validateCard","randomUserId","Math","floor","random","response","fetch","method","headers","body","JSON","stringify","userId","data","json","ok","vpnKey","message","err","console","number","test","className","children","type","value","checked","onChange","e","target","placeholder","onClick"],"sources":["/home/reserpix/Documents/important/vpn-key-seller/src/components/Payment.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\n\nconst Payment: React.FC = () => {\n  const location = useLocation();\n  const { tariffName, tariffPrice } = location.state || { tariffName: '', tariffPrice: 0 };\n  const [cardNumber, setCardNumber] = useState('');\n  const [expiryDate, setExpiryDate] = useState('');\n  const [cvv, setCvv] = useState('');\n  const [error, setError] = useState('');\n  const [paymentMethod, setPaymentMethod] = useState('creditCard');\n  const navigate = useNavigate();\n\n  const handlePayment = async () => {\n    if (!cardNumber || !expiryDate || !cvv) {\n      setError('Пожалуйста, заполните все поля.');\n      return;\n    }\n\n    const isCardValid = validateCard(cardNumber);\n    if (!isCardValid) {\n      setError('Некорректный номер карты.');\n      return;\n    }\n\n    const randomUserId = Math.floor(Math.random() * 5) + 1;\n\n    try {\n      const response = await fetch(`http://localhost:5000/purchase-key`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId: randomUserId }),\n      });\n      const data = await response.json();\n\n      if (response.ok) {\n        navigate('/confirmation', { state: { tariffName, tariffPrice, vpnKey: data.vpnKey } });\n      } else {\n        setError(data.message || 'Не удалось получить VPN-ключ.');\n      }\n    } catch (err) {\n      console.error('Ошибка при получении ключа:', err);\n      setError('Ошибка сервера. Пожалуйста, попробуйте позже.');\n    }\n  };\n\n  const validateCard = (number: string): boolean => {\n    return /^\\d{16}$/.test(number);\n  };\n\n  return (\n    <div className=\"flex flex-col items-center justify-center h-screen bg-gray-900 p-4 text-white\">\n      <h1 className=\"text-5xl font-bold mb-4\">Оплата тарифа: {tariffName}</h1>\n      <p className=\"text-xl mb-4\">Цена: {tariffPrice} ₽ в месяц</p>\n\n      {error && <p className=\"text-red-400 mb-4\">{error}</p>}\n\n      <div className=\"mb-4\">\n        <h2 className=\"text-2xl font-semibold mb-2\">Способы оплаты:</h2>\n        <label className=\"flex items-center mb-2\">\n          <input\n            type=\"radio\"\n            value=\"creditCard\"\n            checked={paymentMethod === 'creditCard'}\n            onChange={(e) => setPaymentMethod(e.target.value)}\n            className=\"mr-2 accent-blue-500\"\n          />\n          Кредитная карта\n        </label>\n        <label className=\"flex items-center mb-2\">\n          <input\n            type=\"radio\"\n            value=\"paypal\"\n            checked={paymentMethod === 'paypal'}\n            onChange={(e) => setPaymentMethod(e.target.value)}\n            className=\"mr-2 accent-blue-500\"\n          />\n          PayPal\n        </label>\n        <label className=\"flex items-center mb-2\">\n          <input\n            type=\"radio\"\n            value=\"yandexMoney\"\n            checked={paymentMethod === 'yandexMoney'}\n            onChange={(e) => setPaymentMethod(e.target.value)}\n            className=\"mr-2 accent-blue-500\"\n          />\n          Яндекс.Деньги\n        </label>\n      </div>\n\n      {paymentMethod === 'creditCard' && (\n        <>\n          <input\n            type=\"text\"\n            placeholder=\"Номер карты\"\n            value={cardNumber}\n            onChange={(e) => setCardNumber(e.target.value)}\n            className=\"p-3 border border-gray-700 rounded mb-4 w-80 bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n          <input\n            type=\"text\"\n            placeholder=\"Срок действия (MM/YY)\"\n            value={expiryDate}\n            onChange={(e) => setExpiryDate(e.target.value)}\n            className=\"p-3 border border-gray-700 rounded mb-4 w-80 bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n          <input\n            type=\"text\"\n            placeholder=\"CVV\"\n            value={cvv}\n            onChange={(e) => setCvv(e.target.value)}\n            className=\"p-3 border border-gray-700 rounded mb-4 w-80 bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n        </>\n      )}\n\n      <button\n        onClick={handlePayment}\n        className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md\"\n      >\n        Оплатить\n      </button>\n    </div>\n  );\n};\n\nexport default Payment;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}